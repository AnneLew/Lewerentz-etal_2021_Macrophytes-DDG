<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Anne Lewerentz, Juliano S. Cabral" />


<title>DDG Analysis | Main results</title>

<script src="analysis_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="analysis_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="analysis_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="analysis_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="analysis_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="analysis_files/navigation-1.1/tabsets.js"></script>
<script src="analysis_files/navigation-1.1/codefolding.js"></script>
<link href="analysis_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="analysis_files/highlightjs-9.12.0/highlight.js"></script>
<link href="analysis_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="analysis_files/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">DDG Analysis | Main results</h1>
<h4 class="author">Anne Lewerentz, Juliano S. Cabral</h4>
<h4 class="date">12 Juni 2020</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#material-methods"><span class="toc-section-number">1</span> Material &amp; methods</a><ul>
<li><a href="#data-overview"><span class="toc-section-number">1.1</span> Data overview</a><ul>
<li><a href="#abiotic-data"><span class="toc-section-number">1.1.1</span> Abiotic data</a></li>
<li><a href="#biotic-data-dataset-levels-overview"><span class="toc-section-number">1.1.2</span> Biotic data, dataset levels overview</a></li>
</ul></li>
</ul></li>
<li><a href="#results"><span class="toc-section-number">2</span> Results</a><ul>
<li><a href="#species-richness-per-dataset-group"><span class="toc-section-number">2.1</span> Species richness per dataset group</a></li>
<li><a href="#species-numbers-in-taxonomic-groups"><span class="toc-section-number">2.2</span> Species numbers in taxonomic groups</a></li>
<li><a href="#gamma-richness-overview-min-max-mean-sd"><span class="toc-section-number">2.3</span> Gamma richness overview: min, max, mean, sd</a></li>
<li><a href="#depth-diversity-gradients"><span class="toc-section-number">2.4</span> Depth diversity gradients</a></li>
<li><a href="#drivers"><span class="toc-section-number">2.5</span> Drivers</a><ul>
<li><a href="#cor.test"><span class="toc-section-number">2.5.1</span> Cor.test</a></li>
<li><a href="#gamm-incl-pca"><span class="toc-section-number">2.5.2</span> GAMM incl PCA</a></li>
</ul></li>
<li><a href="#temporal-change"><span class="toc-section-number">2.6</span> Temporal change</a><ul>
<li><a href="#invariability-analysis"><span class="toc-section-number">2.6.1</span> Invariability analysis</a></li>
<li><a href="#linear-models"><span class="toc-section-number">2.6.2</span> Linear models</a></li>
</ul></li>
</ul></li>
<li><a href="#discussion"><span class="toc-section-number">3</span> Discussion</a><ul>
<li><a href="#summary-figure"><span class="toc-section-number">3.1</span> Summary figure</a></li>
</ul></li>
</ul>
</div>

<div id="material-methods" class="section level1">
<h1><span class="header-section-number">1</span> Material &amp; methods</h1>
<div id="data-overview" class="section level2">
<h2><span class="header-section-number">1.1</span> Data overview</h2>
<div id="abiotic-data" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Abiotic data</h3>
<pre class="r"><code>Chem_overview_SmallDatasetMorph&lt;-Chem_uniform_LOIx %&gt;% 
  filter(datasettot==&quot;LEVEL3&quot;) %&gt;% 
  group_by(Lake)%&gt;% #LEVEL3 means all data with WLF &amp; SAC
  select(Area_ha, maxDepth_m, WLF) %&gt;% unique() %&gt;% ungroup() %&gt;%
  rename_(.dots=setNames(names(.), tolower(gsub(&quot;\\_&quot;, &quot;.&quot;, names(.)))))%&gt;%
  summarise_each(funs(mean, median, min, max, sd),-lake) %&gt;%
  tidyr::gather(variable, value) %&gt;%
  tidyr::separate(variable, c(&quot;var&quot;, &quot;stat&quot;), sep = &quot;\\_&quot;) %&gt;%
  tidyr::spread(var, value)

Chem_overview_SmallDataset&lt;-Chem_uniform_LOIx %&gt;% rowwise() %&gt;% filter(datasettot==&quot;LEVEL3&quot;) %&gt;%
  rename_(.dots=setNames(names(.), tolower(gsub(&quot;\\_&quot;, &quot;.&quot;, names(.)))))%&gt;%ungroup()%&gt;% 
  select(chloride,conduct,nh4n,no3n,ntot,o2diss,ph,ptot,sac,sio2,temp,tempsd,transp,wlf)%&gt;%
  summarise_each(funs(mean, median, min, max, sd))%&gt;%
  tidyr::gather(variable, value) %&gt;%
  tidyr::separate(variable, c(&quot;var&quot;, &quot;stat&quot;), sep = &quot;\\_&quot;) %&gt;%
  tidyr::spread(var, value)#%&gt;%t()

Chem_overview_SmallD&lt;-cbind(Chem_overview_SmallDatasetMorph,Chem_overview_SmallDataset[,2:15]) %&gt;%
  tibble::rownames_to_column() %&gt;%  
  tidyr::gather(var, value, -rowname) %&gt;% 
  tidyr::spread(rowname, value) %&gt;% 
  rename(max=&quot;1&quot;,mean=&quot;2&quot;, median=&quot;3&quot;, min=&quot;4&quot;, sd=&quot;5&quot;)

df&lt;-cbind(Chem_overview_SmallDatasetMorph,Chem_overview_SmallDataset[,2:15]) %&gt;%
  column_to_rownames(var = &quot;stat&quot;) 

dt&lt;-type_convert(as_tibble(cbind(Parameters = names(df), t(df)))) %&gt;% mutate_if(is.numeric, round, 2)
dt %&gt;% 
  select(Parameters,min, max,mean,sd,median)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Parameters"],"name":[1],"type":["chr"],"align":["left"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"area.ha","2":"134.65","3":"7990.00","4":"1887.85","5":"2654.87","6":"624.50"},{"1":"maxdepth.m","2":"15.40","3":"190.00","4":"62.76","5":"51.03","6":"39.65"},{"1":"wlf","2":"0.20","3":"1.18","4":"0.58","5":"0.28","6":"0.59"},{"1":"chloride","2":"0.33","3":"14.98","4":"7.58","5":"3.94","6":"7.61"},{"1":"conduct","2":"158.55","3":"372.44","4":"292.57","5":"61.96","6":"309.20"},{"1":"nh4n","2":"0.00","3":"0.09","4":"0.02","5":"0.02","6":"0.01"},{"1":"no3n","2":"0.00","3":"1.09","4":"0.37","5":"0.28","6":"0.30"},{"1":"ntot","2":"0.19","3":"1.22","4":"0.66","5":"0.22","6":"0.65"},{"1":"o2diss","2":"9.16","3":"11.41","4":"10.23","5":"0.51","6":"10.39"},{"1":"ph","2":"8.04","3":"8.49","4":"8.32","5":"0.11","6":"8.35"},{"1":"ptot","2":"0.00","3":"0.02","4":"0.01","5":"0.00","6":"0.01"},{"1":"sac","2":"0.00","3":"24.83","4":"8.85","5":"7.84","6":"5.35"},{"1":"sio2","2":"0.00","3":"2.86","4":"1.68","5":"0.88","6":"1.64"},{"1":"temp","2":"9.64","3":"19.24","4":"13.38","5":"2.09","6":"13.32"},{"1":"tempsd","2":"0.23","3":"2.24","4":"0.91","5":"0.58","6":"0.62"},{"1":"transp","2":"242.50","3":"1197.27","4":"451.74","5":"198.39","6":"410.00"},{"1":"wlf","2":"0.20","3":"1.18","4":"0.56","5":"0.24","6":"0.59"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="biotic-data-dataset-levels-overview" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Biotic data, dataset levels overview</h3>
<pre class="r"><code>complete&lt;-MakrophS_ALL %&gt;% 
  dplyr::summarise(N = n_distinct(Lake,YEAR),Lakes_N = n_distinct(Lake),Transects_N = n_distinct(MST_NR),Depths_N =n_distinct(Probestelle),Years_N = n_distinct(YEAR))

Level1&lt;-MakrophS_ALL %&gt;% filter(datasettot==&quot;LEVEL3&quot;) %&gt;% #group_by(datasettot) %&gt;% 
  dplyr::summarise(N = n_distinct(Lake,YEAR),Lakes_N = n_distinct(Lake),Transects_N = n_distinct(MST_NR),Depths_N = n_distinct(Probestelle),Years_N = n_distinct(YEAR))

Level_Timeseries&lt;-MakrophS_ALL %&gt;% group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3)%&gt;% ungroup() %&gt;%
  dplyr::summarise(N = n_distinct(Lake,YEAR),Lakes_N = n_distinct(Lake),Transects_N = n_distinct(MST_NR),Depths_N = n_distinct(Probestelle),Years_N = n_distinct(YEAR))


Level&lt;- rbind(complete,Level1,Level_Timeseries)
Level$dataset&lt;-c(&quot;Biotic&quot;,&quot;Biotic+Abiotic&quot;, &quot;Timeseries&quot;)
Level[,c(6,1,2,3,4,5)]</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["dataset"],"name":[1],"type":["chr"],"align":["left"]},{"label":["N"],"name":[2],"type":["int"],"align":["right"]},{"label":["Lakes_N"],"name":[3],"type":["int"],"align":["right"]},{"label":["Transects_N"],"name":[4],"type":["int"],"align":["right"]},{"label":["Depths_N"],"name":[5],"type":["int"],"align":["right"]},{"label":["Years_N"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"Biotic","2":"100","3":"28","4":"274","5":"4","6":"13"},{"1":"Biotic+Abiotic","2":"27","3":"12","4":"147","5":"4","6":"11"},{"1":"Timeseries","2":"73","3":"17","4":"194","5":"4","6":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="results" class="section level1">
<h1><span class="header-section-number">2</span> Results</h1>
<div id="species-richness-per-dataset-group" class="section level2">
<h2><span class="header-section-number">2.1</span> Species richness per dataset group</h2>
<pre class="r"><code>M&lt;-MakrophS_ALL[5:96]
M[colSums(M)!=0] %&gt;% ncol() #75</code></pre>
<pre><code>## [1] 75</code></pre>
<pre class="r"><code>M3&lt;-MakrophS_ALL %&gt;% filter(datasettot==&quot;LEVEL3&quot;) 
M3&lt;-M3[5:96]
M3[colSums(M3)!=0] %&gt;% ncol() #57</code></pre>
<pre><code>## [1] 57</code></pre>
<pre class="r"><code>MT&lt;-MakrophS_ALL %&gt;% group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3)%&gt;% ungroup()
MT&lt;-MT[5:96]
MT[colSums(MT)!=0] %&gt;% ncol() #66</code></pre>
<pre><code>## [1] 66</code></pre>
</div>
<div id="species-numbers-in-taxonomic-groups" class="section level2">
<h2><span class="header-section-number">2.2</span> Species numbers in taxonomic groups</h2>
<pre class="r"><code>species &lt;- as.data.frame(colnames(MakrophS_ALL[5:96]))
names(species)&lt;-&quot;Taxon&quot;
#species
unique(left_join(species,Makroph[c(8,11)],by=c(&quot;Taxon&quot;))) %&gt;% 
  group_by(Erscheinungsform) %&gt;% dplyr::summarise(N=n_distinct(Taxon))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Erscheinungsform"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["N"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Bryophyta","2":"5"},{"1":"Charales","2":"20"},{"1":"Pteridophyta","2":"2"},{"1":"Spermatophyta","2":"65"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="gamma-richness-overview-min-max-mean-sd" class="section level2">
<h2><span class="header-section-number">2.3</span> Gamma richness overview: min, max, mean, sd</h2>
<pre class="r"><code>min(Makroph_Lake_ALL$GAMMA)</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="r"><code>max(Makroph_Lake_ALL$GAMMA)</code></pre>
<pre><code>## [1] 34</code></pre>
<pre class="r"><code>mean(Makroph_Lake_ALL$GAMMA)</code></pre>
<pre><code>## [1] 15.36</code></pre>
<pre class="r"><code>sd(Makroph_Lake_ALL$GAMMA)</code></pre>
<pre><code>## [1] 6.269245</code></pre>
</div>
<div id="depth-diversity-gradients" class="section level2">
<h2><span class="header-section-number">2.4</span> Depth diversity gradients</h2>
<pre class="r"><code>library(ggpmisc)
A1&lt;-ggplot(data=Makroph_Depth)+
 geom_ribbon(aes(x = Tiefe, ymax =mAlpha+sdAlpha, ymin =mAlpha-sdAlpha), alpha = 0.6, fill = &quot;grey&quot;)+
geom_line(aes(x=(Tiefe), y=mAlpha), size=1)+ scale_x_reverse()+
ylab(&quot;Alpha richness&quot;)+xlab((&quot;Depth (m)&quot;))  

formula1 = y ~ poly(x, 3, raw=TRUE)

A2&lt;-ggplot(data = PEAK, aes(x=AlphaPeakDepth, y=AlphaPeakRichness))+
  geom_point(aes(shape=datasettotsimpl),alpha=0.2)+
  scale_shape_discrete(name = &quot;s&quot;, labels = c(&quot;DDG peak, Biodiversity dataset&quot;, &quot;DDG peak, Environmental &amp; biodiversity dataset&quot;))+
  geom_smooth(method=lm,model=lm, formula = formula1,span=1, col=&quot;black&quot;)+
  xlab(expression(D[alpha][max](m)))+
  ylab(expression(R[alpha][max](N)))+
  theme(legend.position = c(0.9, 0.2),legend.title=element_blank())+
  scale_x_reverse()+
   xlim(-0.5,-5)

A3&lt;-ggplot(data=PEAK, aes(x=AlphaPeakDepth))+
  geom_histogram(breaks=c(0,-1,-2,-4,-5), color=&quot;black&quot;,fill=&quot;white&quot;)+#binwidth=1
    scale_x_reverse()+xlab(&quot;Depth (m)&quot;)+ylab(expression(D[alpha][max](counts)))

B1&lt;-ggplot(data=Makroph_Depth)+
  geom_ribbon(aes(x = Tiefe, ymax =mBeta+sdBeta, ymin =mBeta-sdBeta), alpha = 0.6, fill = &quot;grey&quot;)+
  geom_line(aes(x=(Tiefe), y=mBeta), size=1)+ scale_x_reverse()+
  ylab(&quot;Beta richness&quot;)+xlab((&quot;Depth (m)&quot;)) 

B2&lt;-ggplot(data = PEAK, aes(x=BetaPeakDepth, y=BetaPeakRichness))+
  geom_point(aes(shape=datasettotsimpl),alpha=0.2)+
  scale_shape_discrete(name = &quot;s&quot;, labels = c(&quot;DDG peak, Biodiversity dataset&quot;, &quot;DDG peak, Environmental &amp; biodiversity dataset&quot;))+
  geom_smooth(method=lm,model=lm, formula = formula1,span=1, col=&quot;black&quot;)+
  xlab(expression(D[beta][max](m)))+
  ylab(expression(R[beta][max](N)))+
  theme(legend.position = c(0.9, 0.2),legend.title=element_blank())+
  scale_x_reverse()+
   xlim(-0.5,-5) 

B3&lt;-ggplot(data=PEAK, aes(x=BetaPeakDepth))+
  geom_histogram(breaks=c(0,-1,-2,-4,-5), color=&quot;black&quot;,fill=&quot;white&quot;)+#binwidth=1
    scale_x_reverse()+xlab(&quot;Depth (m)&quot;)+ylab(expression(D[beta][max](counts)))

C1&lt;-ggplot(data=Makroph_Depth)+
    geom_ribbon(aes(x = Tiefe, ymax =mGamma+sdGamma, ymin =mGamma-sdGamma), alpha = 0.6, fill = &quot;grey&quot;)+
  geom_line(aes(x=(Tiefe), y=mGamma), size=1, colour=&quot;black&quot;)+ scale_x_reverse()+
  ylab(&quot;Gamma richness&quot;)+xlab((&quot;Depth (m)&quot;)) 

C2&lt;-ggplot(data = PEAK, aes(x=GammaPeakDepth, y=GammaPeakRichness))+
  geom_point(aes(shape=datasettotsimpl),alpha=0.2)+
  scale_shape_discrete(name = &quot;s&quot;, labels = c(&quot;DDG peak, Biodiversity dataset&quot;, &quot;DDG peak, Environmental &amp; biodiversity dataset&quot;))+
  geom_smooth(method=lm,model=lm, formula = formula1,span=1, col=&quot;black&quot;)+
  xlab(expression(D[gamma][max](m)))+
  ylab(expression(R[gamma][max](N)))+
  theme(legend.position = c(0.9, 0.2),legend.title=element_blank())+
  scale_x_reverse()+
   xlim(-0.5,-5) 

C3&lt;-ggplot(data=PEAK, aes(x=GammaPeakDepth))+
  geom_histogram(breaks=c(0,-1,-2,-4,-5), color=&quot;black&quot;,fill=&quot;white&quot;)+#binwidth=1
    scale_x_reverse()+xlab(&quot;Depth (m)&quot;)+ylab(expression(D[gamma][max](counts)))

ggarrange(A1,B1,C1,A2,B2,C2,A3,B3,C3,ncol=3,nrow=3,labels=c(&quot;(a)&quot;,&quot;(b)&quot;,&quot;(c)&quot;,&quot;(d)&quot;,&quot;(e)&quot;,&quot;(f)&quot;,&quot;(g)&quot;,&quot;(h)&quot;,&quot;(i)&quot;),heights = c(2,1.5,1.8),common.legend = T, legend=&quot;bottom&quot;, align = &quot;hv&quot;)</code></pre>
<p><img src="analysis_files/figure-html/figure2-1.png" width="2400" /></p>
</div>
<div id="drivers" class="section level2">
<h2><span class="header-section-number">2.5</span> Drivers</h2>
<div id="cor.test" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Cor.test</h3>
<pre class="r"><code>cor.test(PEAK_Chem_norm$AlphaPeakRichness, PEAK_Chem_norm$Ntot)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  PEAK_Chem_norm$AlphaPeakRichness and PEAK_Chem_norm$Ntot
## t = -2.404, df = 66, p-value = 0.01903
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.48908556 -0.04861211
## sample estimates:
##        cor 
## -0.2837485</code></pre>
<pre class="r"><code># chart.Correlation(PEAK_Chem_norm[c(33,20,22,31,32,29,30,16,19,3:15)], histogram=F, pch=9, method = &quot;pearson&quot;)</code></pre>
</div>
<div id="gamm-incl-pca" class="section level3">
<h3><span class="header-section-number">2.5.2</span> GAMM incl PCA</h3>
<pre class="r"><code>################ PCA ###############################################
label_lake&lt;- PEAK_Chem_norm[complete.cases(PEAK_Chem_norm[,c(3:16,19)]),] #LEVEL 3 data #[,c(3:16,19)] #[,c(8:10,12:16,19)]
lak.pca &lt;- prcomp(na.omit(label_lake[,c(3:16,19)]),center = TRUE, scale. = TRUE)
#print(lak.pca)
#summary(lak.pca) 

PCA &lt;- (data.frame(label_lake$Lake))
PCA$YEAR &lt;- label_lake$YEAR
PCA$PC1 &lt;- lak.pca$x[,1]
PCA$PC2 &lt;- lak.pca$x[,2]
PCA$PC3 &lt;- lak.pca$x[,3]
PCA$PC4 &lt;- lak.pca$x[,4]

names(PCA)[1]&lt;-&quot;Lake&quot;

PEAK_PCA&lt;-merge(PCA, PEAK_Chem_norm, by=c(&quot;Lake&quot;, &quot;YEAR&quot;))

Rotation &lt;-lak.pca$rotation %&gt;% as.data.frame()
Rotation$variable &lt;- row.names(Rotation)
R1&lt;-ggplot(data=Rotation)+
  geom_bar(aes(y=variable,x=PC1,fill = PC1 &gt; 0.4 | PC1&lt; -0.4), stat=&#39;identity&#39;)+
  xlim(-0.65,0.65)+
  #theme(axis.title.y=element_blank(),axis.text.y=element_blank())+
  ylab(&quot;&quot;)+xlab(&quot;loading&quot;)+
  ggtitle(&quot;     PC1 - 30.1% \nSiO2 &amp; Cond axis&quot;)

R2&lt;-ggplot(data=Rotation)+geom_bar(aes(y=variable,x=PC2,fill = PC2 &gt; 0.4 | PC2&lt; -0.4), stat=&#39;identity&#39;)+
  xlim(-0.65,0.65)+
  theme(axis.title.y=element_blank(),axis.text.y=element_blank())+ylab(&quot;&quot;)+
  ggtitle(&quot;     PC2 - 26.1%\nTemp &amp; Ptot axis&quot;)+xlab(&quot;loading&quot;)+ylab(&quot;&quot;)

R3&lt;-ggplot(data=Rotation)+geom_bar(aes(y=variable,x=PC3,fill = PC3 &gt; 0.4 | PC3&lt; -0.4), stat=&#39;identity&#39;)+
  xlim(-0.65,0.65)+ylab(&quot;&quot;)+
  theme(axis.title.y=element_blank(),axis.text.y=element_blank())+
  ggtitle(&quot;     PC3 - 13.3%\nTempsd – Chl axis&quot;)+xlab(&quot;loading&quot;)

R4&lt;-ggplot(data=Rotation)+geom_bar(aes(y=variable,x=PC4,fill = PC4 &gt; 0.4 | PC4&lt; -0.4), stat=&#39;identity&#39;)+
  xlim(-0.65,0.65)+ylab(&quot;&quot;)+
  theme(axis.title.y=element_blank(),axis.text.y=element_blank())+
  ggtitle(&quot;     PC4 - 10.5%\nO2diss – SAC axis&quot;)+xlab(&quot;loading&quot;)




## GAMM
gam_AlphaPeakDepth &lt;- gamm4(AlphaPeakDepth ~ s(PC1)+s(PC2)+s(PC3)+s(PC4),
                            random= ~(1|Lake), # package gamm4
                            data=PEAK_PCA)
summary(gam_AlphaPeakDepth$gam)</code></pre>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## AlphaPeakDepth ~ s(PC1) + s(PC2) + s(PC3) + s(PC4)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -2.0189     0.0575  -35.11   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##          edf Ref.df     F  p-value    
## s(PC1) 3.758  3.758  5.19  0.01055 *  
## s(PC2) 1.000  1.000 29.70 1.89e-05 ***
## s(PC3) 1.000  1.000 13.07  0.00178 ** 
## s(PC4) 1.557  1.557 10.57  0.00602 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.735   
## lmer.REML = 32.009  Scale est. = 0.082528  n = 27</code></pre>
<pre class="r"><code>gam_AlphaPeakRichness &lt;- gamm4(AlphaPeakRichness ~ s(PC1),
                               random= ~(1|Lake), # package gamm4
                               data=PEAK_PCA)
summary(gam_AlphaPeakRichness$gam)</code></pre>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## AlphaPeakRichness ~ s(PC1)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   6.6763     0.4549   14.68 8.56e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##        edf Ref.df     F p-value   
## s(PC1)   1      1 10.14 0.00376 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.439   
## lmer.REML = 84.106  Scale est. = 0.53482   n = 27</code></pre>
<pre class="r"><code>library(voxel)
library(gridExtra)
vars &lt;- c(&quot;PC2&quot;, &quot;PC4&quot;,&quot;PC3&quot;,&quot;PC1&quot;)

library(grid)
# Create a text
grob2 &lt;- grobTree(textGrob(&quot;*** 36.6% dc&quot;, x=0.1,  y=0.9, hjust=0,
  gp=gpar(col=&quot;grey12&quot;, fontsize=13, fontface=&quot;italic&quot;)))

plotPC2&lt;-plotGAMM(gam_AlphaPeakDepth, smooth.cov = &quot;PC2&quot;)  +
    geom_point(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC2&quot;), alpha = 0.2) +
    geom_rug(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC2&quot;), alpha = 0.2) +
    #scale_color_manual(&quot;Private&quot;, values = c(&quot;#868686FF&quot;, &quot;#0073C2FF&quot;)) +
    theme(legend.position=&quot;none&quot;)+
    ylab(&quot;&quot;)+ylim(-3.5,-0.5)+
    ggtitle(&quot;&quot;)+ theme(legend.title = element_blank())+
  annotation_custom(grob2)

grob4 &lt;- grobTree(textGrob(&quot;** 30.3% dc&quot;, x=0.1,  y=0.9, hjust=0,
  gp=gpar(col=&quot;grey12&quot;, fontsize=13, fontface=&quot;italic&quot;)))

vars &lt;- c(&quot;PC4&quot;)
plotPC4&lt;- plotGAMM(gam_AlphaPeakDepth, smooth.cov = &quot;PC4&quot;)  +
    geom_point(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC4&quot;), alpha = 0.2) +
    geom_rug(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC4&quot;), alpha = 0.2) +
    #scale_color_manual(&quot;Private&quot;, values = c(&quot;#868686FF&quot;, &quot;#0073C2FF&quot;)) +
    theme(legend.position=&quot;none&quot;)+theme(legend.title = element_blank())+
    ylab(&quot;&quot;)+ylim(-3.5,-0.5)+
    #ylab(expression(predicted_D[alpha][max]))+
   ggtitle(&quot;&quot;)+ 
  annotation_custom(grob4)

grob3 &lt;- grobTree(textGrob(&quot;** 28.6% dc&quot;, x=0.1,  y=0.9, hjust=0,
  gp=gpar(col=&quot;grey12&quot;, fontsize=13, fontface=&quot;italic&quot;)))
vars &lt;- c(&quot;PC3&quot;)
plotPC3&lt;-plotGAMM(gam_AlphaPeakDepth, smooth.cov = &quot;PC3&quot;)  +
    geom_point(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC3&quot;), alpha = 0.2) +
    geom_rug(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC3&quot;), alpha = 0.2) +
    #scale_color_manual(&quot;Private&quot;, values = c(&quot;#868686FF&quot;, &quot;#0073C2FF&quot;)) +
    theme(legend.position=&quot;none&quot;)+theme(legend.title = element_blank())+
  ylab(&quot;&quot;)+ylim(-3.5,-0.5)+
    #ylab(expression(predicted_D[alpha][max]))+
    ggtitle(&quot;&quot;)+ 
  annotation_custom(grob3)

grob1 &lt;- grobTree(textGrob(&quot;* 25.6% dc&quot;, x=0.1,  y=0.9, hjust=0,
  gp=gpar(col=&quot;grey12&quot;, fontsize=13, fontface=&quot;italic&quot;)))
vars &lt;- c(&quot;PC1&quot;)
plotPC1&lt;-plotGAMM(gam_AlphaPeakDepth, smooth.cov = &quot;PC1&quot;)  +
    geom_point(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC1&quot;), alpha = 0.2) +
    geom_rug(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakDepth&quot;, x = &quot;PC1&quot;), alpha = 0.2) +
    #scale_color_manual(&quot;Private&quot;, values = c(&quot;#868686FF&quot;, &quot;#0073C2FF&quot;)) +
    theme(legend.position=&quot;none&quot;)+
    ylab(expression(predicted_D[alpha][max]))+ylim(-3.5,-0.5)+
    ggtitle(&quot;&quot;)+ theme(legend.title = element_blank())+
  annotation_custom(grob1)

grob5 &lt;- grobTree(textGrob(&quot;**&quot;, x=0.1,  y=0.9, hjust=0,
  gp=gpar(col=&quot;grey12&quot;, fontsize=13, fontface=&quot;italic&quot;)))
vars2 &lt;- c(&quot;PC1&quot;)
plot2&lt;-plotGAMM(gam_AlphaPeakRichness, smooth.cov = &quot;PC1&quot;)  +
    geom_point(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakRichness&quot;, x = &quot;PC1&quot;), alpha = 0.2) +
    geom_rug(data = PEAK_PCA, aes_string(y = &quot;AlphaPeakRichness&quot;, x = &quot;PC1&quot;), alpha = 0.2) +
    #scale_color_manual(&quot;Private&quot;, values = c(&quot;#868686FF&quot;, &quot;#0073C2FF&quot;)) +
    theme(legend.position=&quot;none&quot;)+
    ylab(expression(predicted_R[alpha][max]))+
    #labs(tag = &quot;E&quot;)+
    ggtitle(&quot;&quot;)+  theme(legend.title = element_blank())+
  annotation_custom(grob5)

empty&lt;-plot(0, xaxt = &#39;n&#39;, yaxt = &#39;n&#39;, bty = &#39;n&#39;, pch = &#39;&#39;, ylab = &#39;&#39;, xlab = &#39;&#39;)

ggarrange(R1,R2,R3,R4, 
          ncol=4, common.legend = T, legend=&quot;top&quot;, labels = c(&quot;(a)&quot;,&quot;(b)&quot;,&quot;(c)&quot;,&quot;(d)&quot;), widths = c(1.3,1,1,1))</code></pre>
<p><img src="analysis_files/figure-html/unnamed-chunk-7-1.png" width="3000" /><img src="analysis_files/figure-html/unnamed-chunk-7-2.png" width="3000" /></p>
<pre class="r"><code>ggarrange(plotPC1, plotPC2, plotPC3, plotPC4, plot2,
          ncol=4, nrow=3,
          heights = c(4,3,3),
          common.legend = T, legend=&quot;top&quot;,
          labels = c(&quot;(e)&quot;,&quot;(f)&quot;,&quot;(g)&quot;,&quot;(h)&quot;,&quot;(i)&quot;),
          #widths = c(1.4,1,1,1),
          align = &quot;hv&quot;
          )</code></pre>
<p><img src="analysis_files/figure-html/unnamed-chunk-7-3.png" width="3000" /></p>
<pre class="r"><code>Fig3&lt;-ggarrange(R1,R2,R3,R4, plotPC1, plotPC2, plotPC3, plotPC4, plot2,empty, empty, empty, 
          ncol=4, nrow=3,
          heights = c(4,3,3),
          common.legend = T, legend=&quot;top&quot;,
          labels = c(&quot;(a)&quot;,&quot;(b)&quot;,&quot;(c)&quot;,&quot;(d)&quot;,&quot;(e)&quot;,&quot;(f)&quot;,&quot;(g)&quot;,&quot;(h)&quot;,&quot;(i)&quot;),
          #widths = c(1.4,1,1,1),
          align = &quot;hv&quot;
          )
Fig3</code></pre>
<p><img src="analysis_files/figure-html/unnamed-chunk-7-4.png" width="3000" /></p>
<pre class="r"><code>ggsave(Fig3,plot=Fig3, device = &quot;pdf&quot;,width = 4, height = 4)

pdf(&quot;mtcars.pdf&quot;)
print(Fig3)
dev.off()</code></pre>
<pre><code>## png 
##   2</code></pre>
<pre class="r"><code># GAMMplot&lt;-ggarrange(empty,plotPC1,plotPC2, plotPC3,plotPC4,empty,plot2,   empty, empty, empty,   
#           ncol=5, nrow=2,
#           #heights = c(4,3,3), 
#           common.legend = T, legend=&quot;top&quot;, 
#           labels = c(&quot;&quot;,&quot;(e)&quot;,&quot;(f)&quot;,&quot;(g)&quot;,&quot;(h)&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;(i)&quot;), 
#           widths = c(0.2,1,1,1,1),          
#           align = &quot;hv&quot;
#           )
# grid.arrange(PCAachsisplot,GAMMplot,ncol=1,nrow=2,heights=c(2,3))</code></pre>
</div>
</div>
<div id="temporal-change" class="section level2">
<h2><span class="header-section-number">2.6</span> Temporal change</h2>
<div id="invariability-analysis" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Invariability analysis</h3>
<pre class="r"><code>LAKECHANGEInv&lt;-PEAK %&gt;% 
  dplyr::group_by(Lake) %&gt;% #summarize informtion for lakes (over timeseries)
  dplyr::summarise(NYEAR=n_distinct(YEAR),
             AlphaPeakDepthInv=mean(-AlphaPeakDepth)/sd(-AlphaPeakDepth), 
             AlphaPeakRichnessInv=mean(AlphaPeakRichness)/sd(AlphaPeakRichness),
             BetaPeakDepthInv=mean(-BetaPeakDepth)/sd(-BetaPeakDepth), 
             BetaPeakRichnessInv=mean(BetaPeakRichness)/sd(BetaPeakRichness),
             GammaPeakDepthInv=mean(-GammaPeakDepth)/sd(-GammaPeakDepth),
             GammaPeakRichnessInv=mean(GammaPeakRichness)/sd(GammaPeakRichness),
             GammaRichnessInv=mean(GAMMA)/sd(GAMMA)
             )%&gt;%
  filter(NYEAR&gt;3) %&gt;% #For timeseries dataset
  arrange(AlphaPeakDepthInv) %&gt;% 
  filter_all(all_vars(!is.infinite(.)))

#LAKECHANGEInv 


# ggplot(LAKECHANGEInv %&gt;% gather(Type, &quot;Inv&quot;, 3:9)) +
#   geom_histogram(aes(x=Inv), col=&quot;white&quot;, fill=&quot;black&quot;,binwidth = 1)+
#   facet_wrap(~Type, ncol = 2)+
#   xlab(&quot;Inverse Variation coefficient = Invariability coefficient&quot;)

LAKECHANGEInv%&gt;%
  dplyr::ungroup() %&gt;%
  select(-Lake, -NYEAR)%&gt;%
  dplyr::summarise_all(list(mean=mean,sd=sd), na.rm=TRUE) </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["AlphaPeakDepthInv_mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AlphaPeakRichnessInv_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BetaPeakDepthInv_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["BetaPeakRichnessInv_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["GammaPeakDepthInv_mean"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["GammaPeakRichnessInv_mean"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["GammaRichnessInv_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AlphaPeakDepthInv_sd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["AlphaPeakRichnessInv_sd"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["BetaPeakDepthInv_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["BetaPeakRichnessInv_sd"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["GammaPeakDepthInv_sd"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["GammaPeakRichnessInv_sd"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["GammaRichnessInv_sd"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"6.621196","2":"6.36124","3":"1.561163","4":"5.890581","5":"1.779052","6":"6.516232","7":"7.138026","8":"4.114747","9":"2.872239","10":"0.4909194","11":"2.062524","12":"0.532401","13":"2.975634","14":"3.689056"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="linear-models" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Linear models</h3>
<pre class="r"><code>PEAK&lt;-PEAK %&gt;%mutate(YEAR=as.numeric(YEAR))


GammaModel&lt;-PEAK%&gt;%group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3) %&gt;% 
  do({
    mod = lm(GAMMA ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %&gt;% plyr::rename(c(&quot;Slope&quot;=&quot;GammaSlope&quot;, &quot;pValue&quot;=&quot;GammaPValue&quot;))

AlphaPeakRichnessModel&lt;-PEAK%&gt;%group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3) %&gt;% 
  do({
    mod = lm(AlphaPeakRichness ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %&gt;% plyr::rename(c(&quot;Slope&quot;=&quot;AlphaPeakRichnessSlope&quot;, &quot;pValue&quot;=&quot;AlphaPeakRichnessPValue&quot;))

AlphaPeakDepthModel&lt;-PEAK%&gt;%group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3) %&gt;% 
  do({
    mod = lm(AlphaPeakDepth ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %&gt;% plyr::rename(c(&quot;Slope&quot;=&quot;AlphaPeakDepthSlope&quot;, &quot;pValue&quot;=&quot;AlphaPeakDepthPValue&quot;))

AlphaPeakModel &lt;- merge (AlphaPeakDepthModel, AlphaPeakRichnessModel, by=&quot;Lake&quot;)


BetaPeakRichnessModel&lt;-PEAK%&gt;%group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3) %&gt;% 
  do({
    mod = lm(BetaPeakRichness ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %&gt;% plyr::rename(c(&quot;Slope&quot;=&quot;BetaPeakRichnessSlope&quot;, &quot;pValue&quot;=&quot;BetaPeakRichnessPValue&quot;))

BetaPeakDepthModel&lt;-PEAK%&gt;%group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3) %&gt;% 
  do({
    mod = lm(BetaPeakDepth ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %&gt;% plyr::rename(c(&quot;Slope&quot;=&quot;BetaPeakDepthSlope&quot;, &quot;pValue&quot;=&quot;BetaPeakDepthPValue&quot;))

BetaPeakModel &lt;- merge (BetaPeakDepthModel, BetaPeakRichnessModel, by=&quot;Lake&quot;)

GammaPeakRichnessModel&lt;-PEAK%&gt;%group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3) %&gt;% 
  do({
    mod = lm(GammaPeakRichness ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %&gt;% plyr::rename(c(&quot;Slope&quot;=&quot;GammaPeakRichnessSlope&quot;, &quot;pValue&quot;=&quot;GammaPeakRichnessPValue&quot;))

GammaPeakDepthModel&lt;-PEAK%&gt;%group_by(Lake)%&gt;%filter(n_distinct(YEAR)&gt;3) %&gt;% 
  do({
    mod = lm(GammaPeakDepth ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %&gt;% plyr::rename(c(&quot;Slope&quot;=&quot;GammaPeakDepthSlope&quot;, &quot;pValue&quot;=&quot;GammaPeakDepthPValue&quot;))

GammaPeakModel &lt;- merge (GammaPeakDepthModel, GammaPeakRichnessModel, by=&quot;Lake&quot;)

PeakModel &lt;- merge (AlphaPeakModel,BetaPeakModel,by=&quot;Lake&quot;)
PeakModel &lt;- merge (PeakModel,GammaPeakModel,by=&quot;Lake&quot;)

Model &lt;- merge (GammaModel,PeakModel,by=&quot;Lake&quot;)

ModelT&lt;-Model %&gt;% mutate(GammaTrend=ifelse(Model$GammaSlope&gt;0,&quot;+&quot;,ifelse(Model$GammaSlope&lt;0,&quot;-&quot;,&quot;0&quot;))) %&gt;%
  mutate(GammapV=ifelse(GammaPValue&lt;0.001,&quot;***&quot;,ifelse(GammaPValue&lt;0.01,&quot;**&quot;,ifelse(GammaPValue&lt;0.05,&quot;*&quot;,ifelse(GammaPValue&lt;0.1,&quot;.&quot;,&quot;NA&quot;)))))%&gt;%
  
  mutate(AlphaPeakDepthTrend=ifelse(Model$AlphaPeakDepthSlope&gt;0.5*0,&quot;+&quot;,ifelse(Model$AlphaPeakDepthSlope&lt;0,&quot;-&quot;,&quot;0&quot;))) %&gt;%
  mutate(AlphaPeakDepthpV=ifelse(AlphaPeakDepthPValue&lt;0.001,&quot;***&quot;,ifelse(AlphaPeakDepthPValue&lt;0.01,&quot;**&quot;,ifelse(AlphaPeakDepthPValue&lt;0.05,&quot;*&quot;,ifelse(AlphaPeakDepthPValue&lt;0.1,&quot;.&quot;,&quot;NA&quot;)))))%&gt;%
  
  mutate(AlphaPeakRichnessTrend=ifelse(Model$AlphaPeakRichnessSlope&gt;0,&quot;+&quot;,ifelse(Model$AlphaPeakRichnessSlope&lt;0,&quot;-&quot;,&quot;0&quot;)))%&gt;%
  mutate(AlphaPeakRichnesspV=ifelse(AlphaPeakRichnessPValue&lt;0.001,&quot;***&quot;,ifelse(AlphaPeakRichnessPValue&lt;0.01,&quot;**&quot;,ifelse(AlphaPeakRichnessPValue&lt;0.05,&quot;*&quot;,ifelse(AlphaPeakRichnessPValue&lt;0.1,&quot;.&quot;,&quot;NA&quot;)))))%&gt;%
  
  mutate(BetaPeakDepthTrend=ifelse(Model$BetaPeakDepthSlope&gt;0,&quot;+&quot;,ifelse(Model$BetaPeakDepthSlope&lt;0,&quot;-&quot;,&quot;0&quot;))) %&gt;%
  mutate(BetaPeakDepthpV=ifelse(BetaPeakDepthPValue&lt;0.001,&quot;***&quot;,ifelse(BetaPeakDepthPValue&lt;0.01,&quot;**&quot;,ifelse(BetaPeakDepthPValue&lt;0.05,&quot;*&quot;,ifelse(BetaPeakDepthPValue&lt;0.1,&quot;.&quot;,&quot;NA&quot;)))))%&gt;%
  
  mutate(BetaPeakRichnessTrend=ifelse(Model$BetaPeakRichnessSlope&gt;0,&quot;+&quot;,ifelse(Model$BetaPeakRichnessSlope&lt;0,&quot;-&quot;,&quot;0&quot;)))%&gt;%
  mutate(BetaPeakRichnesspV=ifelse(BetaPeakRichnessPValue&lt;0.001,&quot;***&quot;,ifelse(BetaPeakRichnessPValue&lt;0.01,&quot;**&quot;,ifelse(BetaPeakRichnessPValue&lt;0.05,&quot;*&quot;,ifelse(BetaPeakRichnessPValue&lt;0.1,&quot;.&quot;,&quot;NA&quot;)))))%&gt;%
  
  mutate(GammaPeakDepthTrend=ifelse(Model$GammaPeakDepthSlope&gt;0,&quot;+&quot;,ifelse(Model$GammaPeakDepthSlope&lt;0,&quot;-&quot;,&quot;0&quot;))) %&gt;%
  mutate(GammaPeakDepthpV=ifelse(GammaPeakDepthPValue&lt;0.001,&quot;***&quot;,ifelse(GammaPeakDepthPValue&lt;0.01,&quot;**&quot;,ifelse(GammaPeakDepthPValue&lt;0.05,&quot;*&quot;,ifelse(GammaPeakDepthPValue&lt;0.1,&quot;.&quot;,&quot;NA&quot;)))))%&gt;%
  
  
  mutate(GammaPeakRichnessTrend=ifelse(Model$GammaPeakRichnessSlope&gt;0,&quot;+&quot;,ifelse(Model$GammaPeakRichnessSlope&lt;0,&quot;-&quot;,&quot;0&quot;)))%&gt;%
  mutate(GammaPeakRichnesspV=ifelse(GammaPeakRichnessPValue&lt;0.001,&quot;***&quot;,ifelse(GammaPeakRichnessPValue&lt;0.01,&quot;**&quot;,ifelse(GammaPeakRichnessPValue&lt;0.05,&quot;*&quot;,ifelse(GammaPeakRichnessPValue&lt;0.1,&quot;.&quot;,&quot;NA&quot;)))))


ModelTshort&lt;-ModelT[c(1,16:29)] %&gt;% 
  tidyr::unite(GammaLM, c(&quot;GammaTrend&quot;, &quot;GammapV&quot;))%&gt;% 
  tidyr::unite(AlphaPeakDepthLM, c(&quot;AlphaPeakDepthTrend&quot;, &quot;AlphaPeakDepthpV&quot;))%&gt;% 
  tidyr::unite(AlphaPeakRichnessLM, c(&quot;AlphaPeakRichnessTrend&quot;, &quot;AlphaPeakRichnesspV&quot;))%&gt;% 
  tidyr::unite(BetaPeakDepthLM, c(&quot;BetaPeakDepthTrend&quot;, &quot;BetaPeakDepthpV&quot;))%&gt;% 
  tidyr::unite(BetaPeakRichnessLM, c(&quot;BetaPeakRichnessTrend&quot;, &quot;BetaPeakRichnesspV&quot;))%&gt;% 
  tidyr::unite(GammaPeakDepthLM, c(&quot;GammaPeakDepthTrend&quot;, &quot;GammaPeakDepthpV&quot;))%&gt;% 
  tidyr::unite(GammaPeakRichnessLM, c(&quot;GammaPeakRichnessTrend&quot;, &quot;GammaPeakRichnesspV&quot;))

ModelTshort &lt;- data.frame(lapply(ModelTshort, function(x) {gsub(&quot;_NA&quot;, &quot;&quot;, x)}))
ModelTshort &lt;- data.frame(lapply(ModelTshort, function(x) {gsub(&quot;_&quot;, &quot;&quot;, x)}))

ModelTshort</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Lake"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["GammaLM"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["AlphaPeakDepthLM"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["AlphaPeakRichnessLM"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["BetaPeakDepthLM"],"name":[5],"type":["fctr"],"align":["left"]},{"label":["BetaPeakRichnessLM"],"name":[6],"type":["fctr"],"align":["left"]},{"label":["GammaPeakDepthLM"],"name":[7],"type":["fctr"],"align":["left"]},{"label":["GammaPeakRichnessLM"],"name":[8],"type":["fctr"],"align":["left"]}],"data":[{"1":"Abtsdorfer See","2":"-","3":"-","4":"-","5":"-","6":"+","7":"-","8":"-"},{"1":"Ammersee","2":"-","3":"+","4":"-","5":"+","6":"-","7":"+","8":"-"},{"1":"Chiemsee","2":"+**","3":"+","4":"-","5":"-","6":"+","7":"+","8":"+."},{"1":"Gr. Alpsee","2":"+","3":"-*","4":"+","5":"-","6":"-","7":"-","8":"+"},{"1":"Grosser Ostersee","2":"-","3":"+","4":"-","5":"+","6":"-","7":"+","8":"-"},{"1":"Hopfensee","2":"+","3":"-","4":"+","5":"0","6":"+*","7":"0","8":"+."},{"1":"Niedersonthofener See","2":"-","3":"+","4":"-","5":"+","6":"+","7":"+","8":"-"},{"1":"Pelhamer See","2":"+","3":"-","4":"+","5":"+","6":"-","7":"-","8":"+"},{"1":"Riegsee","2":"+","3":"+","4":"+","5":"+*","6":"+.","7":"+.","8":"+"},{"1":"Schliersee","2":"-","3":"+","4":"-","5":"+","6":"-","7":"-","8":"-"},{"1":"Simssee","2":"+","3":"+","4":"+","5":"+","6":"+","7":"+","8":"+"},{"1":"Staffelsee - Nord","2":"+.","3":"+","4":"+","5":"+","6":"+.","7":"+.","8":"+"},{"1":"Staffelsee - Sued","2":"+*","3":"+","4":"+.","5":"-","6":"+.","7":"+","8":"+."},{"1":"Starnberger See","2":"+.","3":"+.","4":"+***","5":"+","6":"+*","7":"+","8":"+***"},{"1":"Tegernsee","2":"+","3":"+*","4":"+","5":"+","6":"+","7":"+.","8":"+"},{"1":"Waginger See","2":"+","3":"-","4":"+","5":"+","6":"+","7":"+","8":"+"},{"1":"Woerthsee","2":"-","3":"-*","4":"+","5":"+","6":"+","7":"+","8":"+"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="discussion" class="section level1">
<h1><span class="header-section-number">3</span> Discussion</h1>
<div id="summary-figure" class="section level2">
<h2><span class="header-section-number">3.1</span> Summary figure</h2>
<pre class="r"><code>ggplot(data=Makroph_Depth)+
  geom_line(data=Makroph_Depth,aes(x=(Tiefe), y=mAlpha), col=&quot;darkgreen&quot;, size=1)+
  geom_line(data=Makroph_Depth, aes(x=(Tiefe), y=mBeta), col=&quot;green2&quot;, size=1)+ 
  geom_line(data=Makroph_Depth,aes(x=(Tiefe), y=mGamma), col=&quot;lightgreen&quot;, size=1, colour=&quot;black&quot;)+
  ylab(&quot;Richness&quot;)+xlab((&quot;Depth (m)&quot;))+ scale_x_reverse()</code></pre>
<p><img src="analysis_files/figure-html/unnamed-chunk-9-1.png" width="2100" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
