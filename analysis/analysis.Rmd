---
title: "DDG Analysis | Main results"
author: "Anne Lewerentz, Juliano S. Cabral"
date: "12 Juni 2020"
output: 
  html_document:
    toc: true
    number_sections: true
    #fig_caption: true
    df_print: paged
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, message=FALSE, warning=FALSE, dpi=300)
```

```{r load-packages, include=FALSE}
#Load packages
library(dplyr)
library(ggplot2)
library(magrittr)
library(knitr)
library(MacrophytesDDG)
library(ggpubr)
library(data.table) 
library(kableExtra)
library(knitr)
library(corrr)
library(vegan)
library(gamm4)

## ggplot theme updates
source("C:/Users/anl85ck/Desktop/PhD/5_Macrophytes-Bavaria/3_WFD-Project/02_Themes/tidy_white_anne.R")

```

# Introduction
## Data overview

### Abiotic data

```{r}
Chem_overview_SmallDatasetMorph<-Chem_uniform_LOIx %>% filter(datasettot=="LEVEL3") %>% group_by(datasettot)%>%
  summarise(MArea = mean(Area_ha),MinArea = min(Area_ha),MaxArea = max(Area_ha),
            MDepth = mean(maxDepth_m),MinDepth = min(maxDepth_m),MaxDepth = max(maxDepth_m),
            MWLF = mean(WLF),MinWLF= min(WLF),MaxWLF = max(WLF))


Chem_overview_SmallDataset<-Chem_uniform_LOIx %>% rowwise() %>% filter(datasettot=="LEVEL3") %>% group_by(datasettot) %>%
  summarise(MChl = mean(Chloride, na.rm = T),MinChlor = min(Chloride, na.rm = T),MaxChlor = max(Chloride, na.rm = T),
            MCond = mean(Conduct, na.rm = T),MinCond = min(Conduct, na.rm = T),MaxCond = max(Conduct, na.rm = T),
            MN_tot = mean(Ntot, na.rm = T),MinN_tot = min(Ntot, na.rm = T),MaxN_tot = max(Ntot, na.rm = T),
            MNH4N_0 = mean(NH4N, na.rm = T),MinNH4N = min(NH4N, na.rm = T),MaxNH4 = max(NH4N, na.rm = T),
            MNO3N_0 = mean(NO3N, na.rm = T),MinNO3N = min(NO3N, na.rm = T),MaxNO3N = max(NO3N, na.rm = T),
            MO2gel_0 = mean(O2diss, na.rm = T),MinO2gel = min(O2diss, na.rm = T),MaxO2gel = max(O2diss, na.rm = T),
            MPges_0 = mean(Ptot, na.rm = T),MinPges = min(Ptot, na.rm = T),MaxPges = max(Ptot, na.rm = T),
            MpH_0 = mean(pH, na.rm = T),MinpH = min(pH, na.rm = T),MaxpH = max(pH, na.rm = T),
            MSiO2_0 = mean(SiO2, na.rm = T),MinSiO2 = min(SiO2, na.rm = T),MaxSiO2 = max(SiO2, na.rm = T),
            MTemp_0 = mean(Temp, na.rm = T),MinTemp = min(Temp, na.rm = T),MaxTemp = max(Temp, na.rm = T),
            MTransparency = mean(Transp, na.rm = T),MinTransparency = min(Transp, na.rm = T),MaxTransparency = max(Transp, na.rm = T),
            MSAK.254 = mean(SAC, na.rm = T),MinSAK.254 = min(SAC, na.rm = T),MaxSAK.254 = max(SAC, na.rm = T),
            MTemp_0_6_sd = mean(Tempsd, na.rm = T),MinTemp_0_6_sd = min(Tempsd, na.rm = T),MaxTemp_0_6_sd = max(Tempsd, na.rm = T)
  )
Chem_overview_SmallD<-cbind(Chem_overview_SmallDatasetMorph,Chem_overview_SmallDataset[,2:39])
Chem_overview_SmallD


```



### Biotic data 

```{r}

complete<-MakrophS_ALL %>% 
  dplyr::summarise(N = n_distinct(Lake,YEAR),Lakes_N = n_distinct(Lake),Transects_N = n_distinct(MST_NR),Depths_N =n_distinct(Probestelle),Years_N = n_distinct(YEAR))

Level1<-MakrophS_ALL %>% filter(datasettot=="LEVEL3") %>% #group_by(datasettot) %>% 
  dplyr::summarise(N = n_distinct(Lake,YEAR),Lakes_N = n_distinct(Lake),Transects_N = n_distinct(MST_NR),Depths_N = n_distinct(Probestelle),Years_N = n_distinct(YEAR))

Level_Timeseries<-MakrophS_ALL %>% group_by(Lake)%>%filter(n_distinct(YEAR)>3)%>% ungroup() %>%
  dplyr::summarise(N = n_distinct(Lake,YEAR),Lakes_N = n_distinct(Lake),Transects_N = n_distinct(MST_NR),Depths_N = n_distinct(Probestelle),Years_N = n_distinct(YEAR))


Level<- rbind(complete,Level1,Level_Timeseries)
Level$dataset<-c("Biotic","Biotic+Abiotic", "Timeseries")
Level[,c(6,1,2,3,4,5)]
```

## Species richness

```{r}
M<-MakrophS_ALL[5:96]
M[colSums(M)!=0] %>% ncol() #75
M3<-MakrophS_ALL %>% filter(datasettot=="LEVEL3") 
M3<-M3[5:96]
M3[colSums(M3)!=0] %>% ncol() #57
MT<-MakrophS_ALL %>% group_by(Lake)%>%filter(n_distinct(YEAR)>3)%>% ungroup()
MT<-MT[5:96]
MT[colSums(MT)!=0] %>% ncol() #66


```



# Results
## H1 Pattern
### Depth diversity gradients : Full datasets

```{r, fig.height=3, fig.width=8}
A1<-ggplot(data=Makroph_Lake_DepthS)+
  geom_line(aes(x=Tiefe, y=ALPHA, group=interaction(Lake, YEAR)),col="grey")+ scale_x_reverse()+
  geom_line(data=Makroph_Depth,aes(x=(Tiefe), y=mAlpha))+ 
  geom_errorbar(data=Makroph_Depth,aes(x=(Tiefe),ymin=mAlpha-sdAlpha, ymax=mAlpha+sdAlpha), width=.1)+
  ylab("Alpha richness")+xlab(("Depth (m)"))
B1<-ggplot(data=Makroph_Lake_DepthS)+
  geom_line(aes(x=Tiefe, y=BETA, group=interaction(Lake, YEAR)),col="grey")+ scale_x_reverse()+
  geom_line(data=Makroph_Depth,aes(x=(Tiefe), y=mBeta))+ 
  geom_errorbar(data=Makroph_Depth,aes(x=(Tiefe),ymin=mBeta-sdBeta, ymax=mBeta+sdBeta), width=.1)+
  ylab("Beta richness")+xlab(("Depth (m)"))
C1<-ggplot(data=Makroph_Lake_DepthS)+
  geom_line(aes(x=Tiefe, y=GAMMA, group=interaction(Lake, YEAR)),col="grey")+ scale_x_reverse()+
  geom_line(data=Makroph_Depth,aes(x=(Tiefe), y=mGamma))+ 
  geom_errorbar(data=Makroph_Depth,aes(x=(Tiefe),ymin=mGamma-sdGamma, ymax=mGamma+sdGamma), width=.1)+
  ylab("Gamma richness")+xlab(("Depth (m)"))
ggarrange(A1,B1,C1,ncol=3,nrow=1,labels=c("(a)","(b)","(c)"))
```

### Pattern analysis



```{r}

PEAK$DepthGroup<-if_else(PEAK$AlphaPeakDepth>-1,"Decreasing curve (Peak: >-1m)",
                                  if_else(PEAK$AlphaPeakDepth>-2,"Hump-shaped (Peak: -1- -2m)",
                                          if_else(PEAK$AlphaPeakDepth>-4,"Hump-shaped (Peak -2- -4m)","Increasing curve (Peak: <-4m)")))

PEAKCLASSAlpha<-PEAK %>% group_by(DepthGroup) %>% dplyr::summarise(Alpha_N=n_distinct(interaction(Lake,YEAR)))


PEAKCLASS2<-PEAK  %>% group_by(GammaPeakDepth) %>% dplyr::summarise(datasets=n_distinct(interaction(Lake,YEAR))) 
PEAKCLASS2$DepthGroup<-if_else(PEAKCLASS2$GammaPeakDepth>-1,"Decreasing curve (Peak: >-1m)",
                                  if_else(PEAKCLASS2$GammaPeakDepth>-2,"Hump-shaped (Peak: -1- -2m)",
                                  if_else(PEAKCLASS2$GammaPeakDepth>-4,"Hump-shaped (Peak -2- -4m)","Increasing curve (Peak: <-4m)")))
PEAKCLASSGamma<-PEAKCLASS2 %>% group_by(DepthGroup) %>% dplyr::summarise(Gamma_N=sum(datasets))

PEAKCLASS3<-PEAK %>% group_by(BetaPeakDepth) %>% dplyr::summarise(datasets=n_distinct(interaction(Lake,YEAR)))
PEAKCLASS3$DepthGroup<-if_else(PEAKCLASS3$BetaPeakDepth>-1,"Decreasing curve (Peak: >-1m)",
                                  if_else(PEAKCLASS3$BetaPeakDepth>-2,"Hump-shaped (Peak: -1- -2m)",
                                  if_else(PEAKCLASS3$BetaPeakDepth>-4,"Hump-shaped (Peak -2- -4m)","Increasing curve (Peak: <-4m)")))
PEAKCLASSBeta<-PEAKCLASS3 %>% group_by(DepthGroup) %>% dplyr::summarise(Beta_N=sum(datasets))



transpose(left_join(left_join(PEAKCLASSAlpha,PEAKCLASSBeta, by="DepthGroup"),PEAKCLASSGamma,by="DepthGroup"), 
          keep.names = "col", make.names = "DepthGroup")


```

### Peak plots

```{r Peak plots, fig.height=3, fig.width=8}
PPalpha<-peakplot(PEAK,PEAK$AlphaPeakDepth,PEAK$AlphaPeakRichness)
PPbeta<-peakplot(PEAK,PEAK$BetaPeakDepth,PEAK$BetaPeakRichness)
PPgamma<-peakplot(PEAK,PEAK$GammaPeakDepth,PEAK$GammaPeakRichness)


ggarrange(PPalpha,PPbeta,PPgamma, ncol=3,common.legend = T, legend="bottom", labels=c("(a)","(b)","(c)"))
```

## Repr

```{r}

adonis2(PEAK[,c(3,5)]~datasettotsimpl, data=PEAK, by = NULL) #ALPHAPEAK
adonis2((PEAK[,c(14,15)])~datasettotsimpl, data=PEAK, by = NULL) #GammaPEAK
adonis2(scale(PEAK[,c(16,17)])~datasettotsimpl, data=PEAK, by = NULL) #BetaPEAK
```


## H2 Drivers


### Correlations

```{r, fig.width=14, fig.height=5}
PEAK_Chem_norm[c(33,20,22,31,32,29,30,16,19,3:15)] %>% 
  correlate(use="pairwise.complete.obs", method = "pearson") %>% 
  network_plot(min_cor=0.5)
```




### PCA


```{r PCA, fig.height=2.5, fig.width=6.54}
################ PCA ###############################################

label_lake<- PEAK_Chem_norm[complete.cases(PEAK_Chem_norm[,c(3:16,19)]),] #LEVEL 3 data #[,c(3:16,19)] #[,c(8:10,12:16,19)]
lak.pca <- prcomp(na.omit(label_lake[,c(3:16,19)]),center = TRUE, scale. = TRUE)
#print(lak.pca)
#summary(lak.pca) 

PCA <- (data.frame(label_lake$Lake))
PCA$YEAR <- label_lake$YEAR
PCA$PC1 <- lak.pca$x[,1]
PCA$PC2 <- lak.pca$x[,2]
PCA$PC3 <- lak.pca$x[,3]
PCA$PC4 <- lak.pca$x[,4]

names(PCA)[1]<-"Lake"

PEAK_PCA<-merge(PCA, PEAK_Chem_norm, by=c("Lake", "YEAR"))

par(mfrow=c(1,4))
axis1<-barplot(lak.pca$rotation[,1], main="PC1", las=2,horiz = TRUE)
axis2<-barplot(lak.pca$rotation[,2], main="PC2", yaxt='n',horiz = TRUE, las=2)
axis3<-barplot(lak.pca$rotation[,3], main="PC3", yaxt='n',horiz = TRUE, las=2)
axis4<-barplot(lak.pca$rotation[,4], main="PC4", yaxt='n',horiz = TRUE, las=2)

```


### GAMM

```{r GAMM, fig.height=3, fig.width=10}

gam_AlphaPeakDepth <- gamm4(AlphaPeakDepth ~ s(PC1)+s(PC2)+s(PC3)+s(PC4),
                            random= ~(1|Lake), # package gamm4
                            data=PEAK_PCA)
summary(gam_AlphaPeakDepth$gam)


gam_AlphaPeakRichness <- gamm4(AlphaPeakRichness ~ s(PC1),
                               random= ~(1|Lake), # package gamm4
                               data=PEAK_PCA)
summary(gam_AlphaPeakRichness$gam)


par(mfrow=c(1,5))

plot(gam_AlphaPeakDepth$gam,residuals=TRUE, main = expression(D[alpha][max]), shade = T,seWithMean=T, select=2)
text(-2, 1.0, "(a)", cex=2)
plot(gam_AlphaPeakDepth$gam,residuals=TRUE, main = expression(D[alpha][max]), shade = T,seWithMean=T, select=4)
text(-2, 1.0, "(b)", cex=2)
plot(gam_AlphaPeakDepth$gam,residuals=TRUE, main = expression(D[alpha][max]), shade = T,seWithMean=T, select=3)
text(-2, 1.0, "(c)", cex=2)
plot(gam_AlphaPeakDepth$gam,residuals=TRUE, main = expression(D[alpha][max]), shade = T,seWithMean=T, select=1)
text(-3.5, 1.0, "(d)", cex=2)
plot(gam_AlphaPeakRichness$gam,residuals=TRUE, main = expression(R[alpha][max]), shade = T,seWithMean=T)
text(-4, 3.5, "(e)", cex=2)


```



## H3: Temporal change

### Range

```{r Variability, fig.height=2, fig.width=9}
LAKECHANGE<-PEAK%>% dplyr::group_by(Lake) %>%
   dplyr::summarise(NYEAR=n_distinct(YEAR),
             AlphaPeakDepthmean=mean(AlphaPeakDepth),
             AlphaPeakDepthRange=max(AlphaPeakDepth)-min(AlphaPeakDepth),
             AlphaPeakDepthsd=sd(AlphaPeakDepth),
             AlphaPeakRichnessnmean=mean(AlphaPeakRichness),
             AlphaPeakRichnessRange=max(AlphaPeakRichness)-min(AlphaPeakRichness),
             BetaPeakDepthmean=mean(BetaPeakDepth),
             BetaPeakDepthRange=max(BetaPeakDepth)-min(BetaPeakDepth), 
             BetaPeakRichnessnmean=mean(BetaPeakRichness),
             BetaPeakRichnessRange=max(BetaPeakRichness)-min(BetaPeakRichness),
             GammaPeakDepthmean=mean(GammaPeakDepth),
             GammaPeakDepthRange=max(GammaPeakDepth)-min(GammaPeakDepth),
             GammaPeakDepthsd=sd(GammaPeakDepth),
             GammaPeakRichnessnmean=mean(GammaPeakRichness),
             GammaPeakRichnessRange=max(GammaPeakRichness)-min(GammaPeakRichness)
             )%>%
   filter(NYEAR>3) #For timeseries dataset

 LAKECHANGE2<-LAKECHANGE %>%
   mutate(APeakDepthRangeClass=ifelse(AlphaPeakDepthRange<1,"0-1m",
                                      ifelse(AlphaPeakDepthRange<2,"1-2m",
                                             ifelse(AlphaPeakDepthRange<3,"2-3m",
                                                    ifelse(AlphaPeakDepthRange<4,"3-4m",
                                                           ifelse(AlphaPeakDepthRange<5,"4-5m",99))))),
          BPeakDepthRangeClass=ifelse(BetaPeakDepthRange<1,"0-1m",
                                      ifelse(BetaPeakDepthRange<2,"1-2m",
                                             ifelse(BetaPeakDepthRange<3,"2-3m",
                                                    ifelse(BetaPeakDepthRange<4,"3-4m",
                                                           ifelse(BetaPeakDepthRange<5,"4-5m",99))))),
          GPeakDepthRangeClass=ifelse(GammaPeakDepthRange<1,"0-1m",
                                      ifelse(GammaPeakDepthRange<2,"1-2m",
                                             ifelse(GammaPeakDepthRange<3,"2-3m",
                                                    ifelse(GammaPeakDepthRange<4,"3-4m",
                                                           ifelse(GammaPeakDepthRange<5,"4-5m",99))))))

AA<-LAKECHANGE2%>%
  group_by(APeakDepthRangeClass)%>%
  dplyr::summarise(AlphaPeakDepthRange=n_distinct(Lake))%>%
   dplyr::rename(PeakDepthRangeClass=APeakDepthRangeClass)
BA<-LAKECHANGE2%>%
  group_by(BPeakDepthRangeClass)%>%
  dplyr::summarise(BetaPeakDepthRange=n_distinct(Lake))%>%
   dplyr::rename(PeakDepthRangeClass=BPeakDepthRangeClass)
GA<-LAKECHANGE2%>%
  group_by(GPeakDepthRangeClass)%>%
  dplyr::summarise(GammaPeakDepthRange=n_distinct(Lake))%>%
  dplyr::rename(PeakDepthRangeClass=GPeakDepthRangeClass)

AB<-full_join(AA,BA,by=c("PeakDepthRangeClass"))
ABG<-full_join(AB,GA,by=c("PeakDepthRangeClass"))
ABGs<-ABG %>% tidyr::gather("Type", "Nlakes", -PeakDepthRangeClass)

positions <- c("GammaPeakDepthRange","BetaPeakDepthRange", "AlphaPeakDepthRange" )
ggplot(ABGs,aes(x=(Type),y=Nlakes,fill=PeakDepthRangeClass))+
   geom_col(position = position_stack(reverse = TRUE))+
   xlab("")+ylab("Lakes (N)")+
   coord_flip()+
   scale_x_discrete(limits = positions,labels=c("AlphaPeakDepthRange" = bquote("D"[alpha][max]), "BetaPeakDepthRange" =         
                                                  bquote("D"[beta][max]), "GammaPeakDepthRange" = bquote("D"[gamma][max])))+ 
   scale_fill_discrete(name = bquote("D"[max] ~"range" ))
                                                            
```


### Linear models

```{r Linear models, message=FALSE, warning=FALSE}
PEAK<-PEAK %>%mutate(YEAR=as.numeric(YEAR))


GammaModel<-PEAK%>%group_by(Lake)%>%filter(n_distinct(YEAR)>3) %>% 
  do({
    mod = lm(GAMMA ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %>% plyr::rename(c("Slope"="GammaSlope", "pValue"="GammaPValue"))

AlphaPeakRichnessModel<-PEAK%>%group_by(Lake)%>%filter(n_distinct(YEAR)>3) %>% 
  do({
    mod = lm(AlphaPeakRichness ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %>% plyr::rename(c("Slope"="AlphaPeakRichnessSlope", "pValue"="AlphaPeakRichnessPValue"))

AlphaPeakDepthModel<-PEAK%>%group_by(Lake)%>%filter(n_distinct(YEAR)>3) %>% 
  do({
    mod = lm(AlphaPeakDepth ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %>% plyr::rename(c("Slope"="AlphaPeakDepthSlope", "pValue"="AlphaPeakDepthPValue"))

AlphaPeakModel <- merge (AlphaPeakDepthModel, AlphaPeakRichnessModel, by="Lake")


BetaPeakRichnessModel<-PEAK%>%group_by(Lake)%>%filter(n_distinct(YEAR)>3) %>% 
  do({
    mod = lm(BetaPeakRichness ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %>% plyr::rename(c("Slope"="BetaPeakRichnessSlope", "pValue"="BetaPeakRichnessPValue"))

BetaPeakDepthModel<-PEAK%>%group_by(Lake)%>%filter(n_distinct(YEAR)>3) %>% 
  do({
    mod = lm(BetaPeakDepth ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %>% plyr::rename(c("Slope"="BetaPeakDepthSlope", "pValue"="BetaPeakDepthPValue"))

BetaPeakModel <- merge (BetaPeakDepthModel, BetaPeakRichnessModel, by="Lake")

GammaPeakRichnessModel<-PEAK%>%group_by(Lake)%>%filter(n_distinct(YEAR)>3) %>% 
  do({
    mod = lm(GammaPeakRichness ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %>% plyr::rename(c("Slope"="GammaPeakRichnessSlope", "pValue"="GammaPeakRichnessPValue"))

GammaPeakDepthModel<-PEAK%>%group_by(Lake)%>%filter(n_distinct(YEAR)>3) %>% 
  do({
    mod = lm(GammaPeakDepth ~ YEAR, data = .)
    data.frame(Slope = coef(mod)[2],pValue=lmp(mod))
  }) %>% plyr::rename(c("Slope"="GammaPeakDepthSlope", "pValue"="GammaPeakDepthPValue"))

GammaPeakModel <- merge (GammaPeakDepthModel, GammaPeakRichnessModel, by="Lake")

PeakModel <- merge (AlphaPeakModel,BetaPeakModel,by="Lake")
PeakModel <- merge (PeakModel,GammaPeakModel,by="Lake")

Model <- merge (GammaModel,PeakModel,by="Lake")

ModelT<-Model %>% mutate(GammaTrend=ifelse(Model$GammaSlope>0,"+",ifelse(Model$GammaSlope<0,"-","0"))) %>%
  mutate(GammapV=ifelse(GammaPValue<0.001,"***",ifelse(GammaPValue<0.01,"**",ifelse(GammaPValue<0.05,"*",ifelse(GammaPValue<0.1,".","NA")))))%>%
  
  mutate(AlphaPeakDepthTrend=ifelse(Model$AlphaPeakDepthSlope>0.5*0,"+",ifelse(Model$AlphaPeakDepthSlope<0,"-","0"))) %>%
  mutate(AlphaPeakDepthpV=ifelse(AlphaPeakDepthPValue<0.001,"***",ifelse(AlphaPeakDepthPValue<0.01,"**",ifelse(AlphaPeakDepthPValue<0.05,"*",ifelse(AlphaPeakDepthPValue<0.1,".","NA")))))%>%
  
  mutate(AlphaPeakRichnessTrend=ifelse(Model$AlphaPeakRichnessSlope>0,"+",ifelse(Model$AlphaPeakRichnessSlope<0,"-","0")))%>%
  mutate(AlphaPeakRichnesspV=ifelse(AlphaPeakRichnessPValue<0.001,"***",ifelse(AlphaPeakRichnessPValue<0.01,"**",ifelse(AlphaPeakRichnessPValue<0.05,"*",ifelse(AlphaPeakRichnessPValue<0.1,".","NA")))))%>%
  
  mutate(BetaPeakDepthTrend=ifelse(Model$BetaPeakDepthSlope>0,"+",ifelse(Model$BetaPeakDepthSlope<0,"-","0"))) %>%
  mutate(BetaPeakDepthpV=ifelse(BetaPeakDepthPValue<0.001,"***",ifelse(BetaPeakDepthPValue<0.01,"**",ifelse(BetaPeakDepthPValue<0.05,"*",ifelse(BetaPeakDepthPValue<0.1,".","NA")))))%>%
  
  mutate(BetaPeakRichnessTrend=ifelse(Model$BetaPeakRichnessSlope>0,"+",ifelse(Model$BetaPeakRichnessSlope<0,"-","0")))%>%
  mutate(BetaPeakRichnesspV=ifelse(BetaPeakRichnessPValue<0.001,"***",ifelse(BetaPeakRichnessPValue<0.01,"**",ifelse(BetaPeakRichnessPValue<0.05,"*",ifelse(BetaPeakRichnessPValue<0.1,".","NA")))))%>%
  
  mutate(GammaPeakDepthTrend=ifelse(Model$GammaPeakDepthSlope>0,"+",ifelse(Model$GammaPeakDepthSlope<0,"-","0"))) %>%
  mutate(GammaPeakDepthpV=ifelse(GammaPeakDepthPValue<0.001,"***",ifelse(GammaPeakDepthPValue<0.01,"**",ifelse(GammaPeakDepthPValue<0.05,"*",ifelse(GammaPeakDepthPValue<0.1,".","NA")))))%>%
  
  
  mutate(GammaPeakRichnessTrend=ifelse(Model$GammaPeakRichnessSlope>0,"+",ifelse(Model$GammaPeakRichnessSlope<0,"-","0")))%>%
  mutate(GammaPeakRichnesspV=ifelse(GammaPeakRichnessPValue<0.001,"***",ifelse(GammaPeakRichnessPValue<0.01,"**",ifelse(GammaPeakRichnessPValue<0.05,"*",ifelse(GammaPeakRichnessPValue<0.1,".","NA")))))


ModelTshort<-ModelT[c(1,16:29)] %>% 
  tidyr::unite(GammaLM, c("GammaTrend", "GammapV"))%>% 
  tidyr::unite(AlphaPeakDepthLM, c("AlphaPeakDepthTrend", "AlphaPeakDepthpV"))%>% 
  tidyr::unite(AlphaPeakRichnessLM, c("AlphaPeakRichnessTrend", "AlphaPeakRichnesspV"))%>% 
  tidyr::unite(BetaPeakDepthLM, c("BetaPeakDepthTrend", "BetaPeakDepthpV"))%>% 
  tidyr::unite(BetaPeakRichnessLM, c("BetaPeakRichnessTrend", "BetaPeakRichnesspV"))%>% 
  tidyr::unite(GammaPeakDepthLM, c("GammaPeakDepthTrend", "GammaPeakDepthpV"))%>% 
  tidyr::unite(GammaPeakRichnessLM, c("GammaPeakRichnessTrend", "GammaPeakRichnesspV"))

ModelTshort <- data.frame(lapply(ModelTshort, function(x) {gsub("_NA", "", x)}))
ModelTshort <- data.frame(lapply(ModelTshort, function(x) {gsub("_", "", x)}))

ModelTshort

```



